{"ast":null,"code":"import _regeneratorRuntime from\"C:/\\u0421\\u0430\\u0439\\u0442\\u044B/react/music-project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/\\u0421\\u0430\\u0439\\u0442\\u044B/react/music-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"C:/\\u0421\\u0430\\u0439\\u0442\\u044B/react/music-project/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/\\u0421\\u0430\\u0439\\u0442\\u044B/react/music-project/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/\\u0421\\u0430\\u0439\\u0442\\u044B/react/music-project/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/\\u0421\\u0430\\u0439\\u0442\\u044B/react/music-project/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import Loading from'../pages/Loading';import{addSong,getFavoriteSongs,removeSong}from'../services/favoriteSongsAPI';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MusicCard=/*#__PURE__*/function(_React$Component){_inherits(MusicCard,_React$Component);var _super=_createSuper(MusicCard);function MusicCard(){var _this;_classCallCheck(this,MusicCard);_this=_super.call(this);_this.addFav=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var song;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:song=_this.props.song;_this.setState({loading:true});_context.next=4;return addSong(song);case 4:_this.setState({loading:false});case 5:case\"end\":return _context.stop();}}},_callee);}));_this.removeFav=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var song;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:song=_this.props.song;_this.setState({loading:true});_context2.next=4;return removeSong(song);case 4:_this.setState({loading:false});case 5:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleFavs=function(_ref3){var target=_ref3.target;if(target.checked){_this.setState({checked:target.checked},_this.addFav);}else{_this.setState({checked:target.checked},_this.removeFav);}};_this.returnFavs=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var song,favs,favsSongs;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:song=_this.props.song;_context3.next=3;return getFavoriteSongs();case 3:favs=_context3.sent;favsSongs=favs.some(function(msc){return msc.trackId===song.trackId;});_this.setState({checked:favsSongs});case 6:case\"end\":return _context3.stop();}}},_callee3);}));_this.state={loading:false,checked:false};return _this;}_createClass(MusicCard,[{key:\"componentDidMount\",value:function componentDidMount(){this.returnFavs();}},{key:\"render\",value:function render(){var song=this.props.song;var trackName=song.trackName,previewUrl=song.previewUrl,trackId=song.trackId;var _this$state=this.state,loading=_this$state.loading,checked=_this$state.checked;return/*#__PURE__*/_jsxs(\"div\",{children:[loading&&/*#__PURE__*/_jsx(Loading,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"fav\",children:[/*#__PURE__*/_jsx(\"h4\",{children:trackName}),/*#__PURE__*/_jsxs(\"audio\",{\"data-testid\":\"audio-component\",src:previewUrl,controls:true,children:[/*#__PURE__*/_jsx(\"track\",{kind:\"captions\"}),\"\\u0412\\u0430\\u0448 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440 \\u043D\\u0435 \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0432\\u0430\\u0435\\u0442 \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\",' ',/*#__PURE__*/_jsx(\"code\",{children:\"\\u0410\\u0443\\u0434\\u0438\\u043E\"})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"favorite\",className:\"labelFav\",children:[\"\\u0418\\u0437\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435\",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"favorite\",\"data-testid\":\"checkbox-music-\".concat(trackId),onChange:this.handleFavs,name:\"favorite\",checked:checked})]})]})]});}}]);return MusicCard;}(React.Component);export default MusicCard;","map":{"version":3,"names":["React","Loading","addSong","getFavoriteSongs","removeSong","MusicCard","addFav","song","props","setState","loading","removeFav","handleFavs","target","checked","returnFavs","favs","favsSongs","some","msc","trackId","state","trackName","previewUrl","Component"],"sources":["C:/Сайты/react/music-project/src/components/MusicCard.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport Loading from '../pages/Loading';\nimport { addSong, getFavoriteSongs, removeSong } from '../services/favoriteSongsAPI';\n\nclass MusicCard extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      loading: false,\n      checked: false,\n    };\n  }\n\n  componentDidMount() {\n    this.returnFavs();\n  }\n\n  addFav = async () => {\n    const { song } = this.props;\n    this.setState({ loading: true });\n    await addSong(song);\n    this.setState({ loading: false });\n  }\n\n  removeFav = async () => {\n    const { song } = this.props;\n    this.setState({ loading: true });\n    await removeSong(song);\n    this.setState({ loading: false });\n  }\n\n  handleFavs = ({ target }) => {\n    if (target.checked) {\n      this.setState({ checked: target.checked }, this.addFav);\n    } else {\n      this.setState({ checked: target.checked }, this.removeFav);\n    }\n  }\n\n  returnFavs = async () => {\n    const { song } = this.props;\n    const favs = await getFavoriteSongs();\n    const favsSongs = favs.some((msc) => msc.trackId === song.trackId);\n    this.setState({ checked: favsSongs });\n  }\n\n  render() {\n    const { song } = this.props;\n    const { trackName, previewUrl, trackId } = song;\n    const { loading, checked } = this.state;\n    return (\n      <div>\n        {loading && <Loading /> }\n        <div className=\"fav\">\n          <h4>{ trackName }</h4>\n          <audio data-testid=\"audio-component\" src={ previewUrl } controls>\n            <track kind=\"captions\" />\n            Ваш браузер не поддерживает элемент\n            {' '}\n            <code>Аудио</code>\n          </audio>\n          <label htmlFor=\"favorite\" className=\"labelFav\">\n            Избранное\n            <input\n              type=\"checkbox\"\n              id=\"favorite\"\n              data-testid={ `checkbox-music-${trackId}` }\n              onChange={ this.handleFavs }\n              name=\"favorite\"\n              checked={ checked }\n            />\n          </label>\n        </div>\n      </div>\n    );\n  }\n}\n\nMusicCard.propTypes = {\n  song: PropTypes.arrayOf(PropTypes.string).isRequired,\n};\n\nexport default MusicCard;\n"],"mappings":"k0BAAA,MAAOA,MAAK,KAAM,OAAO,CAEzB,MAAOC,QAAO,KAAM,kBAAkB,CACtC,OAASC,OAAO,CAAEC,gBAAgB,CAAEC,UAAU,KAAQ,8BAA8B,CAAC,2FAE/EC,UAAS,kHACb,oBAAc,2CACZ,wBAAQ,MAYVC,MAAM,wEAAG,8IACCC,IAAI,CAAK,MAAKC,KAAK,CAAnBD,IAAI,CACZ,MAAKE,QAAQ,CAAC,CAAEC,OAAO,CAAE,IAAK,CAAC,CAAC,CAAC,sBAC3BR,QAAO,CAACK,IAAI,CAAC,QACnB,MAAKE,QAAQ,CAAC,CAAEC,OAAO,CAAE,KAAM,CAAC,CAAC,CAAC,sDACnC,SAEDC,SAAS,wEAAG,mJACFJ,IAAI,CAAK,MAAKC,KAAK,CAAnBD,IAAI,CACZ,MAAKE,QAAQ,CAAC,CAAEC,OAAO,CAAE,IAAK,CAAC,CAAC,CAAC,uBAC3BN,WAAU,CAACG,IAAI,CAAC,QACtB,MAAKE,QAAQ,CAAC,CAAEC,OAAO,CAAE,KAAM,CAAC,CAAC,CAAC,wDACnC,SAEDE,UAAU,CAAG,eAAgB,IAAbC,OAAM,OAANA,MAAM,CACpB,GAAIA,MAAM,CAACC,OAAO,CAAE,CAClB,MAAKL,QAAQ,CAAC,CAAEK,OAAO,CAAED,MAAM,CAACC,OAAQ,CAAC,CAAE,MAAKR,MAAM,CAAC,CACzD,CAAC,IAAM,CACL,MAAKG,QAAQ,CAAC,CAAEK,OAAO,CAAED,MAAM,CAACC,OAAQ,CAAC,CAAE,MAAKH,SAAS,CAAC,CAC5D,CACF,CAAC,OAEDI,UAAU,wEAAG,kKACHR,IAAI,CAAK,MAAKC,KAAK,CAAnBD,IAAI,wBACOJ,iBAAgB,EAAE,QAA/Ba,IAAI,gBACJC,SAAS,CAAGD,IAAI,CAACE,IAAI,CAAC,SAACC,GAAG,QAAKA,IAAG,CAACC,OAAO,GAAKb,IAAI,CAACa,OAAO,GAAC,CAClE,MAAKX,QAAQ,CAAC,CAAEK,OAAO,CAAEG,SAAU,CAAC,CAAC,CAAC,wDACvC,GArCC,MAAKI,KAAK,CAAG,CACXX,OAAO,CAAE,KAAK,CACdI,OAAO,CAAE,KACX,CAAC,CAAC,aACJ,CAAC,uDAED,4BAAoB,CAClB,IAAI,CAACC,UAAU,EAAE,CACnB,CAAC,sBA+BD,iBAAS,CACP,GAAQR,KAAI,CAAK,IAAI,CAACC,KAAK,CAAnBD,IAAI,CACZ,GAAQe,UAAS,CAA0Bf,IAAI,CAAvCe,SAAS,CAAEC,UAAU,CAAchB,IAAI,CAA5BgB,UAAU,CAAEH,OAAO,CAAKb,IAAI,CAAhBa,OAAO,CACtC,gBAA6B,IAAI,CAACC,KAAK,CAA/BX,OAAO,aAAPA,OAAO,CAAEI,OAAO,aAAPA,OAAO,CACxB,mBACE,uBACGJ,OAAO,eAAI,KAAC,OAAO,IAAG,cACvB,aAAK,SAAS,CAAC,KAAK,wBAClB,oBAAMY,SAAS,EAAO,cACtB,eAAO,cAAY,iBAAiB,CAAC,GAAG,CAAGC,UAAY,CAAC,QAAQ,6BAC9D,cAAO,IAAI,CAAC,UAAU,EAAG,kMAExB,GAAG,cACJ,wDAAkB,GACZ,cACR,eAAO,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,iFAE5C,cACE,IAAI,CAAC,UAAU,CACf,EAAE,CAAC,UAAU,CACb,uCAAgCH,OAAO,CAAI,CAC3C,QAAQ,CAAG,IAAI,CAACR,UAAY,CAC5B,IAAI,CAAC,UAAU,CACf,OAAO,CAAGE,OAAS,EACnB,GACI,GACJ,GACF,CAEV,CAAC,uBAxEqBd,KAAK,CAACwB,SAAS,EA+EvC,cAAenB,UAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}